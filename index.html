<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NetworkDraw</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Menu Bar -->
        <nav class="menu-bar" style="background:#222; color:#ccc; padding:8px 16px;">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <!-- File Menu (Left) -->
                <ul style="list-style:none; margin:0; padding:0; display:flex; align-items:center;">
                    <li style="position:relative;">
                        <button id="fileMenuBtn" style="background:none; border:none; color:#ccc; font-size:16px; padding:8px 16px; cursor:pointer;">File ▼</button>
                        <ul id="fileMenuDropdown" style="display:none; position:absolute; left:0; top:100%; background:#333; color:#ccc; min-width:120px; box-shadow:0 2px 8px #000a; border-radius:0 0 6px 6px; z-index:1001; list-style:none; margin:0; padding:4px 0;">
                            <li><button id="menuNewBtn" style="background:none; border:none; color:#ccc; width:100%; text-align:left; padding:8px 16px; cursor:pointer;">New</button></li>
                            <li><button id="menuSaveBtn" style="background:none; border:none; color:#ccc; width:100%; text-align:left; padding:8px 16px; cursor:pointer;">Save</button></li>
                            <li><button id="menuOpenBtn" style="background:none; border:none; color:#ccc; width:100%; text-align:left; padding:8px 16px; cursor:pointer;">Open</button></li>
                        </ul>
                    </li>
                </ul>
                
                <!-- Generate Code Button (Center) -->
                <div style="display:flex; justify-content:center; align-items:center;">
                    <button id="generateCodeBtn" style="background:#333; border:1px solid #555; color:#ccc; padding:8px 16px; border-radius:4px; cursor:pointer; font-size:14px;">Generate Code</button>
                </div>
                
                <!-- Tools (Right) -->
                <div style="display:flex; align-items:center; gap:10px;">
                    <div class="tool-group" style="display:flex; align-items:center; gap:5px;">
                        <label for="nodeCount" style="color:#ccc; font-size:14px;">Legs:</label>
                        <input type="number" id="nodeCount" min="1" value="4" style="width:50px; background:#333; color:#ccc; border:1px solid #555; border-radius:3px; padding:2px 4px;">
                    </div>
                    <div class="tool-group" style="display:flex; align-items:center; gap:5px;">
                        <label for="tensorName" style="color:#ccc; font-size:14px;">Name:</label>
                        <input type="text" id="tensorName" placeholder="Tensor name" style="width:80px; background:#333; color:#ccc; border:1px solid #555; border-radius:3px; padding:2px 4px;">
                    </div>
                    <button id="circleTool" class="tool-btn active" title="Draw Circular Tensor" style="background:#333; border:1px solid #555; color:#ccc; padding:6px; border-radius:3px; cursor:pointer;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                        </svg>
                    </button>
                    <button id="rectTool" class="tool-btn" title="Draw Rectangular Tensor" style="background:#333; border:1px solid #555; color:#ccc; padding:6px; border-radius:3px; cursor:pointer;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18"/>
                        </svg>
                    </button>
                    <button id="bondTool" class="tool-btn" title="Create Bond or Leg (Only in-legs can connect to out-legs)" style="background:#333; border:1px solid #555; color:#ccc; padding:6px; border-radius:3px; cursor:pointer;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="4" y1="12" x2="20" y2="12"/>
                            <circle cx="4" cy="12" r="2"/>
                            <circle cx="20" cy="12" r="2"/>
                        </svg>
                    </button>
                    <button id="gridTool" class="tool-btn active" title="Toggle Grid" style="background:#333; border:1px solid #555; color:#ccc; padding:6px; border-radius:3px; cursor:pointer;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 3h18v18H3z"/>
                            <path d="M3 9h18"/>
                            <path d="M3 15h18"/>
                            <path d="M9 3v18"/>
                            <path d="M15 3v18"/>
                        </svg>
                    </button>
                    <div id="freeNodeCounterContainer" style="display:flex; align-items:center; gap:5px;">
                        <label for="freeNodeCounterInput" style="color:#ccc; font-size:14px;">Next Free Node:</label>
                        <input id="freeNodeCounterInput" type="number" min="1" style="width:50px; background:#333; color:#ccc; border:1px solid #555; border-radius:3px; padding:2px 4px;" />
                    </div>
                    <button id="resetViewBtn" class="tool-btn" title="Reset View" style="background:#333; border:1px solid #555; color:#ccc; padding:6px; border-radius:3px; cursor:pointer;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
                            <path d="M21 3v5h-5"/>
                            <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
                            <path d="M3 21v-5h5"/>
                        </svg>
                    </button>
                </div>
            </div>
        </nav>
        
        <main>
            <canvas id="canvas"></canvas>
        </main>
        
        <!-- Context Menu -->
        <div id="contextMenu" class="context-menu" style="display:none; position:absolute; z-index:1000; background:#222; color:#ccc; border-radius:8px; box-shadow:0 2px 8px #000a; padding:16px; min-width:200px;">
            <div class="context-menu-item" style="margin-bottom:12px;">
                <label style="color:#ccc; display:block; margin-bottom:4px;">Legs:</label>
                <input type="number" id="contextNodeCount" min="1" value="4" style="width:100%; background:#333; color:#ccc; border:1px solid #555; border-radius:4px; padding:4px;">
            </div>
            <div class="context-menu-item" style="margin-bottom:12px;">
                <label style="color:#ccc; display:block; margin-bottom:4px;">Name:</label>
                <input type="text" id="contextTensorName" placeholder="Tensor name" style="width:100%; background:#333; color:#ccc; border:1px solid #555; border-radius:4px; padding:4px;">
            </div>
            <div class="context-menu-item" style="margin-bottom:12px;">
                <label style="color:#ccc; display:block; margin-bottom:4px;">Leg's Separator:</label>
                <input type="number" id="contextLegThreshold" min="0" value="0" style="width:100%; background:#333; color:#ccc; border:1px solid #555; border-radius:4px; padding:4px;">
                <span style="font-size:90%; color:#aaa; display:block; margin-top:2px;">(legs ≤ separator are out-legs, legs > separator are in-legs)</span>
            </div>
            <div class="context-menu-item" style="margin-bottom:12px;">
                <label style="color:#ccc; display:block; margin-bottom:4px;">Color:</label>
                <input type="color" id="contextColor" value="#ffffff" style="width:100%; background:#333; border:1px solid #555; border-radius:4px; padding:2px;">
            </div>
            <div class="context-menu-item" style="margin-bottom:12px;">
                <label style="color:#ccc; display:block; margin-bottom:4px;">Rotate by (degrees):</label>
                <div class="input-button-group" style="display:flex; gap:8px;">
                    <input type="number" id="contextRotateAngle" value="90" min="-360" max="360" step="15" style="flex:1; background:#333; color:#ccc; border:1px solid #555; border-radius:4px; padding:4px;">
                    <button id="rotateBtn" class="context-btn" style="background:#444; color:#ccc; border:1px solid #666; padding:4px 8px; border-radius:4px; cursor:pointer;">Rotate</button>
                </div>
            </div>
            <div class="context-menu-item" style="margin-bottom:8px;">
                <button id="reflectVerticalBtn" class="context-btn full-width" title="Reflect about vertical axis" style="background:#444; color:#ccc; border:1px solid #666; padding:6px 8px; border-radius:4px; cursor:pointer; width:100%; text-align:left;">Reflect about vertical axis</button>
            </div>
            <div class="context-menu-item" style="margin-bottom:8px;">
                <button id="reflectHorizontalBtn" class="context-btn full-width" title="Reflect about horizontal axis" style="background:#444; color:#ccc; border:1px solid #666; padding:6px 8px; border-radius:4px; cursor:pointer; width:100%; text-align:left;">Reflect about horizontal axis</button>
            </div>
            <div class="context-menu-item" style="margin-bottom:8px;">
                <button id="conjugateBtn" class="context-btn full-width" title="Conjugate tensor (swap in/out legs and add prime to name)" style="background:#444; color:#ccc; border:1px solid #666; padding:6px 8px; border-radius:4px; cursor:pointer; width:100%; text-align:left;">Conjugate Tensor</button>
            </div>
            <div class="context-menu-item">
                <button id="deleteCircleBtn" class="delete-btn" style="background:#d32f2f; color:#fff; border:none; padding:6px 8px; border-radius:4px; cursor:pointer; width:100%;">Delete Tensor</button>
            </div>
        </div>
        <!-- Bond Context Menu -->
        <div id="bondContextMenu" style="display:none; position:absolute; z-index:1000; background:#222; color:#ccc; border-radius:8px; box-shadow:0 2px 8px #000a; padding:16px; min-width:200px;">
            <div style="margin-bottom:12px;">
                <label for="bondColorPicker" style="color:#ccc; display:block; margin-bottom:4px;">Color:</label>
                <input type="color" id="bondColorPicker" value="#ffffff" style="width:100%; background:#333; border:1px solid #555; border-radius:4px; padding:2px;">
            </div>
            <div style="margin-bottom:12px;">
                <label for="bondScalingInput" style="color:#ccc; display:block; margin-bottom:4px;">Scaling:</label>
                <div style="display:flex; align-items:center; gap:4px; background:#333; border:1px solid #555; border-radius:4px; padding:4px;">
                    <input type="text" id="bondPrefactorInput" value="1" style="width:60px; background:#333; color:#ccc; border:none; padding:2px; text-align:right; -moz-appearance: textfield; -webkit-appearance: textfield; appearance: textfield;">
                    <span style="color:#ccc; font-family:serif;">χ</span>
                    <input type="text" id="bondExponentInput" value="1" style="width:60px; background:#333; color:#ccc; border:none; padding:2px; text-align:left; -moz-appearance: textfield; -webkit-appearance: textfield; appearance: textfield;">
                </div>
                <span style="font-size:90%; color:#aaa; display:block; margin-top:2px;">(scales as a*χ^b)</span>
            </div>
            <button id="deleteBondBtn" style="background:#d32f2f; color:#fff; border:none; padding:6px 8px; border-radius:4px; cursor:pointer; width:100%; margin-bottom:8px;">Delete Bond</button>
            <button id="closeBondContextMenuBtn" style="background:#444; color:#ccc; border:1px solid #666; padding:6px 8px; border-radius:4px; cursor:pointer; width:100%;">Close</button>
        </div>
    </div>
    
    <script src="script.js"></script>
</body>
</html> 